"use strict";jQuery(document).ready(function(n){var o=window.pagenow.length?window.pagenow:"";window.typenow.length&&window.typenow;if("edit-product"===o){var e=n(".facebook-for-woocommerce-product-visibility-toggle");e.tipTip({attribute:"title",edgeOffset:5,fadeIn:50,fadeOut:50,delay:200}),e.on("click",function(o){o.preventDefault();var e=n(this).data("action"),c="show"===e?"yes":"no",t=parseInt(n(this).data("product-id"),10);"show"===e?n(this).hide().next("button").show():"hide"===e&&n(this).hide().prev("button").show(),n.post(facebook_for_woocommerce_products_admin.ajax_url,{action:"facebook_for_woocommerce_set_products_visibility",security:facebook_for_woocommerce_products_admin.set_product_visibility_nonce,products:[{product_id:t,visibility:c}]})});var i=!1;n("input#doaction, input#doaction2").on("click",function(o){if(i)return!0;o.preventDefault();var e=n(this),c=e.prev("select").val();if("facebook_exclude"===c||"facebook_include"===c){var t=[];n.each(n('input[name="post[]"]:checked'),function(){t.push(parseInt(n(this).val(),10))}),n.post(facebook_for_woocommerce_products_admin.ajax_url,{action:"facebook_for_woocommerce_set_product_sync_bulk_action_prompt",security:facebook_for_woocommerce_products_admin.set_product_sync_bulk_action_prompt_nonce,toggle:c,products:t},function(o){o&&!o.success?(n("#wc-backbone-modal-dialog .modal-close").trigger("click"),new n.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:o.data}),n(".facebook-for-woocommerce-toggle-product-visibility").on("click",function(o){blockModal(),n(this).hasClass("hide-products")&&n.each(t,function(){var o=n("#post-"+this).find("td.facebook_catalog_visibility button.facebook-for-woocommerce-product-visibility-hide");o.is(":visible")&&o.trigger("click")}),i=!0,e.trigger("click")})):(i=!0,e.trigger("click"))})}else i=!0,e.trigger("click")})}if("product"===o){var c=function(o,e){e.find(".enable-if-sync-enabled").prop("disabled",!o)},t=n("#fb_sync_enabled"),r=t.closest(".woocommerce_options_panel");t.on("click",function(){c(n(this).prop("checked"),r)}),c(t.prop("checked"),r),n(".woocommerce_variations").on("change",".js-variable-fb-sync-toggle",function(){c(n(this).prop("checked"),n(this).closest(".wc-metabox-content"))}),n("#woocommerce-product-data").on("change",".js-fb-product-image-source",function(){var o=n(this).closest(".woocommerce_options_panel, .wc-metabox-content"),e=n(this).val();o.find(".product-image-source-field").closest(".form-field").hide(),o.find(".show-if-product-image-source-"+e).closest(".form-field").show()}),n(".js-fb-product-image-source:checked").trigger("change"),n("#woocommerce-product-data").on("woocommerce_variations_loaded",function(){n(".js-variable-fb-sync-toggle").trigger("change"),n(".js-fb-product-image-source:checked").trigger("change")});var s=!1;n('form#post input[type="submit"]').on("click",function(o){if(s)return!0;o.preventDefault();var e=n(this),c=n('input[name="fb_visibility"]'),t=parseInt(n("input#post_ID").val(),10),i=[],r=n('textarea[name="tax_input[product_tag]"]').val().split(","),a=n("input#fb_sync_enabled").prop("checked");n('#taxonomy-product_cat input[name="tax_input[product_cat][]"]:checked').each(function(){i.push(parseInt(n(this).val(),10))}),0<t?n.post(facebook_for_woocommerce_products_admin.ajax_url,{action:"facebook_for_woocommerce_set_product_sync_prompt",security:facebook_for_woocommerce_products_admin.set_product_sync_prompt_nonce,sync_enabled:a?"enabled":"disabled",product:t,categories:i,tags:r},function(o){o&&!o.success&&(a||!a&&c.length&&c.is(":checked"))?(n("#wc-backbone-modal-dialog .modal-close").trigger("click"),new n.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:o.data}),n(".facebook-for-woocommerce-toggle-product-visibility").on("click",function(o){blockModal(),n(this).hasClass("hide-products")&&c.prop("checked",!1),s=!0,e.trigger("click")})):(s=!0,e.trigger("click"))}):(s=!0,e.trigger("click"))})}});